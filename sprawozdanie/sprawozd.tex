%@descr: wzór sprawozdania, raportu lub pracy - nadaje siê do przeróbek
%@author: Maciej Komosiñski

\documentclass{article} 
\usepackage{polski} %moze wymagac dokonfigurowania latexa, ale jest lepszy ni¿ standardowy babel'owy [polish] 
\usepackage[cp1250]{inputenc} 
\usepackage[OT4]{fontenc} 
\usepackage{graphicx,color} %include pdf's (and png's for raster graphics... avoid raster graphics!) 
\usepackage{url} 
\usepackage[pdftex,hyperfootnotes=false,pdfborder={0 0 0}]{hyperref} %za wszystkimi pakietami; pdfborder nie wszedzie tak samo zaimplementowane bo specyfikacja nieprecyzyjna; pod miktex'em po prostu nie widac wtedy ramek
\usepackage{float}

\input{_ustawienia.tex}

%\title{Sprawozdanie z laboratorium:\\Metaheurystyki i Obliczenia Inspirowane Biologicznie}
%\author{}
%\date{}


\begin{document}

\input{_tytulowa}



\section{Wstêp}
Problem komiwoja¿era opisywany jest czêsto jako problem wêdrownego sprzedawcy zamierzaj¹cego odwiedziæ pewien zbiór miast. Planuj¹c swoj¹ podró¿, usi³uje on znaleŸæ mo¿liwie najkrótsz¹ trasê, która koñczy³aby siê w punkcie startowym. Zak³ada siê, ¿e ka¿de miasto z wyj¹tkiem pocz¹tkowego powinno zostaæ odwiedzone tylko jeden raz. Przyjmuje siê równie¿, ¿e ka¿da para miast po³¹czona jest drog¹ o okreœlonej d³ugoœci.  Opis ten stanowi jedynie ilustracjê  ogólniejszego zagadnienia. Zapisuj¹c Problem Komiwoja¿era w jêzyku teorii grafów, mo¿na zdefiniowaæ go jako problem znajdowania takiego cyklu Hamiltona w pe³nym grafie wa¿onym, dla którego suma wag odwiedzonych krawêdzi jest minimalna. W tak zdefiniowanym problemie mo¿na wyró¿niæ Asymetryczny problem Komiwoja¿era (ATSP). Zak³ada siê w nim, ¿e odleg³oœæ pomiêdzy dwoma miastami A i B mo¿e byæ ró¿na w zale¿noœci od tego, czy sprzedawca przemieszcza siê z punktu A do B, czy te¿ w kierunku przeciwnym. Zarówno symetryczna jak i asymetryczna wersja problemu komiwoja¿era znalaz³a bardzo szerokie zastosowanie w praktyce. Jej wykorzystanie nie ogranicza siê jedynie do problemów zwi¹zanych z transportem. Problem komiwoja¿era stosowany jest miêdzy innymi w produkcji elektroniki, gdzie optymalizuje siê drogê lasera wypalaj¹cego obwody elektroniczne. W sieciach komputerowych zastosowany jest do optymalizacji tras routingu. Niestety opisywany problem jest problemem o wyk³adniczej z³o¿onoœci obliczeniowej i nale¿y do klasy problemów NP-trudnych.
\section{Operator s¹siedztwa}
W zaimplementowanych przez nas algorytmach wykorzystaliœmy operator s¹siedztwa 2-opt. W podejœciu tym, ka¿da permutacja oznaczaj¹ca kolejnoœæ odwiedzanych wierzcho³ków w grafie s¹siaduje z permutacjami utworzonymi poprzez zamianê miejscami dwóch liczb w sekwencji. Rozmiar s¹siedztwa (n), mo¿na obliczyæ za pomoc¹ wzoru:
\[n = \frac{l * (l-1)}{ 2}\]
gdzie l -- liczba wierzcho³ków  

\section{Porównanie dzia³ania 8 algorytmów i rodzajów s¹siedztw na wszystkich instancjach problemów}
w ka¿dym z wykresów przyjêliœmy podobn¹ konwencjê nazewnictwa algorytmów wystêpuj¹c¹ w legendach do nich. Oto objaœnienie:

greedy -- algorytm wybieraj¹cy dane rozwi¹zanie przegladaj¹c zadane s¹siedztwo wtedy, kiedy napotka lepsze od aktualnego

random-greedy -- algorytm w pe³ni losowy ( rzucaj¹cy losow¹ permutacjê ) dzia³aj¹cy tak d³ugo jak greedy

nearest neighbour -- prosta heurystyka dobudowuj¹ca najbli¿sze miasto do rozwi¹zania
random-walker-steepest - algorytm losowo skacz¹cy po s¹siedztwie o czasie dzia³ania takim jak steepest

steepest -- algorytm przeszukuj¹cy ca³e s¹siedztwo i wybieraj¹cy najlepszego kandydata
random-walker-greedy - algorytm losowo skacz¹cy po s¹siedztwie o czasie dzia³ania takim jak greedy

random-steepest -- algorytm losowy dzia³aj¹cy tak d³ugo jak steepest

tabu-search -- algorytm z zaimplementowanym przeszukiwaniem tabu

sa -- algorytm symulowanego wy¿arzania
\subsection{Odleg³oœæ od optimum.}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/best_results_distance_from_optimum2log.pdf}
\end{center}
\caption{Odleg³oœci od optimum najlepszych znalezionych rozwi¹zañ dla kilku przyk³adowych algorytmów. }
\label{fig-schemat}
\end{figure}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/avarage_results_distance_from_optimum2log.pdf}
\end{center}
\caption{Odleg³oœci od optimum wartoœci œrednich ze znalezionych rozwi¹zañ dla kilku przyk³adowych algorytmów. }
\label{fig-schemat}
\end{figure}
 
Jak widaæ na za³¹czonych wykresach w kontekœcie wzglêdnej odleg³oœci od optimum ( liczonej jako odleg³oœæ najlepszego wyniku od optimum podzielonego przez optimum ) algorytmy greedy i steepest maj¹ bardzo zbli¿one rezultaty. Najlepsze wyniki osi¹gn¹³ algorytm Tabu Search. Znalezione przez niego permutacje, okaza³y siê najbli¿sze rozwi¹zaniu optymalnemu. Rezultaty osi¹gniête przez algorytm Simulated annealing (SA), œrednio by³y gorsze od tych znalezionych przez algorytmy Greedy i Steepest. Najlepsze rozwi¹zania znajdywane przez ten algorytm, by³y jednak porównywalne z algorytmem Tabu Search.  Najgorszymi natomiast okaza³y siê byæ algorytmy losowe, zwracaj¹ce losow¹ permutacjê, dzia³aj¹ce tak d³ugo jak odpowiednio greedy i steepest. Widzimy wiêc, ¿e proste heurystyki i algorytmy losowe wypadaj¹ znacznie gorzej ni¿ podejœcia greedy i steepest.




\subsection{Porównanie czasu dzia³ania algorytmów.}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/time.pdf}
\end{center}
\caption{Porównanie œrednich czasów dzia³ania algorytmów. }
\label{fig-schemat}
\end{figure}

Jednak¿e dobre rezultaty obarczone s¹ d³ugimi czasami dzia³ania algorytmów Greedy, Steepest oraz Tabu Search. Wszystkie proste Heurystyki maj¹ niewielki wp³yw rozmiaru instancji na czas dzia³ania. Natomiast w przypadku wymienionych wczeœniej algorytmów rozmiar odgrywa kluczow¹ rolê w tej kwestii. Rozmiar instancji ma szczególnie du¿y wp³yw na czas dzia³ania algorytmu Tabu Search. W tym przypadku, algorytm realizuj¹c ka¿dy krok,  musi przeszukaæ ca³¹ listê Tabu, której rozmiar równie¿ jest zale¿ny od rozmiaru instancji (liczba elementów listy tabu jest równa liczbie wierzcho³ków podzielonej przez 4). Warto zwróciæ uwagê na stosunkowo niewielkie czasy dzia³ania algorytmu SA. 




\subsection{Porównanie efektywnoœci algorytmów.}

W celu porównania efektywnoœci dzia³ania algorytmów wprowadzono miarê: 

\[Efektywnosc = \frac{1}{ \frac{wynik - optimum}{optimum} * czas }\]

Zosta³a ona tak zaprojektowana aby efektywnoœæ by³a tym wiêksza im mniejsza jest œrednia odleg³oœæ otrzymanych wyników od optimum oraz im krótszy jest czas dzia³ania algorytmu.


\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/efficiency2log.pdf}
\end{center}
\caption{Porównanie efektywnoœci algorytmów.}
\label{fig-schemat}
\end{figure}

Powy¿szy wykres zawiera porównanie efektywnoœci algorytmów. Jak mo¿na zauwa¿yæ najlepsz¹ efektywnoœæ osi¹gnê³y algorytmy Greedy, oraz heurystyka nearest neighbour. Najni¿sz¹ efektywnoœæ osi¹gnê³y algorytmy losowe oraz (w przypadku ma³ych instancji problemu) algorytm SA. 

\subsection{Porównanie œredniej liczby kroków oraz liczby ocenionych rozwi¹zañ dla algorytmów steepest, greedy, tabu search i symulowanego wy¿arzania.}
\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/avg_stepslog.pdf}
\end{center}
\caption{Porównanie œredniej liczby kroków algorytmów greedy i steepest w zale¿noœci od rozmiaru instancji problemu.}
\label{fig-schemat}
\end{figure}

Jak mo¿na zauwa¿yæ na wykresie, algorytmy Steepest oraz Greedy, wykonuj¹ najmniej kroków. W przypadku obu algorytmów, ich liczba ograniczona jest przez monotonicznoœæ przestrzeni rozwi¹zañ. Wiêksza liczba kroków, realizowana przez algorytm Greedy, spowodowana jest tym, ¿e jego rozwi¹zania wolniej zbiegaj¹ do lokalnego optimum. Algorytmy Tabu Search oraz SA, realizuj¹ wiêksz¹ liczbê kroków. Du¿y wp³yw na takie wyniki ma warunek stopu, ustalony dla algorytmów (liczba kroków algorytmu, bez poprawy wyniku). Dodatkowo, algorytmy te nie musz¹ zatrzymywaæ siê w lokalnych optimach.    

\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/avg_evalslog.pdf}
\end{center}
\caption{Porównanie œredniej liczby ocen rozwi¹zañ  w zale¿noœci od rozmiaru instancji problemu -- Algorytmy steepest, greedy, symylowane wy¿arzanie oraz tabu search.}
\label{fig-schemat}
\end{figure}

Rozbie¿noœæ tych wykresów jest doœæ oczywista. Steepest zawsze przegl¹da ca³e s¹siedztwo w poszukiwaniu optimum, greedy natomiast tylko jego fragment, próbuj¹æ uzyskaæ poprawê wyniku. Algorytm Tabu Search, tworz¹c listê kandydatów ocenia podobnie jak algorytm Steepest, wszystkich swoich s¹siadów. Poniewa¿ algorytm Tabu Search realizuje œrednio wiêcej kroków ni¿ algorytm Steepest, w trakcie swojego dzia³ania dokonuje on wiêkszej liczby ocen rozwi¹zañ.   

\section{Jakoœæ rozwi¹zania koñcowego w zale¿noœci od jakoœci rozwi¹zania pocz¹tkowego.}
\subsection{Instancja p43.}


\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/best-vs-first/p43-greedy-efficiency.pdf}
\end{center}
\caption{Odleg³oœci od optimum rozwi¹zañ koñcowych w zale¿noœci od odleg³oœci od optimum rozwi¹zañ pocz¹tkowych. Instancja p43 - algorytm Greedy}
\label{fig-schemat}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/best-vs-first/p43-steepest-efficiency.pdf}
\end{center}
\caption{Odleg³oœci od optimum rozwi¹zañ koñcowych w zale¿noœci od odleg³oœci od optimum rozwi¹zañ pocz¹tkowych. Instancja p43 - algorytm Steepest}
\label{fig-schemat}
\end{figure}

\subsection{Instancja ft53.}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/best-vs-first/ft53-greedy-efficiency.pdf}
\end{center}
\caption{Odleg³oœci od optimum rozwi¹zañ koñcowych w zale¿noœci od odleg³oœci od optimum rozwi¹zañ pocz¹tkowych. Instancja ft53 - algorytm Greedy}
\label{fig-schemat}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/best-vs-first/ft53-steepest-efficiency.pdf}
\end{center}
\caption{Odleg³oœci od optimum rozwi¹zañ koñcowych w zale¿noœci od odleg³oœci od optimum rozwi¹zañ pocz¹tkowych. Instancja ft53 -- algorytm Steepest}
\label{fig-schemat}
\end{figure}


\subsection{Instancja ry48p.}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/best-vs-first/ry48p-greedy-efficiency.pdf}
\end{center}
\caption{Odleg³oœci od optimum rozwi¹zañ koñcowych w zale¿noœci od odleg³oœci od optimum rozwi¹zañ pocz¹tkowych. Instancja ry48p - algorytm Greedy}
\label{fig-schemat}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/best-vs-first/ry48p-steepest-efficiency.pdf}
\end{center}
\caption{Odleg³oœci od optimum rozwi¹zañ koñcowych w zale¿noœci od odleg³oœci od optimum rozwi¹zañ pocz¹tkowych. Instancja ry48p -- algorytm Steepest}
\label{fig-schemat}
\end{figure}


Ka¿dy wykres pokazuje nam, ¿e zawsze koñczymy w rezultacie lepszym ni¿ ten z którego zaczynaliœmy podró¿. Dwa z trzech przypadków nie daje ciekawych zale¿noœci, jednak¿e warto spojrzeæ na p43. Tworz¹ siê tam klastry œci¹gaj¹ce podobne rozwi¹zania pocz¹tkowe do podobnych rozwi¹zañ koñcowych.

\section{Zale¿noœæ œrednich i najlepszych rozwi¹zañ od liczby restartów algorytmu. }

\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/multisteepest_ftv44.png}
\end{center}
\caption{Zale¿noœæ œrednich i najlepszych rozwi¹zañ od liczby restartów algorytmu - steepest dla pliku ftv44}
\label{fig-schemat}
\end{figure}


\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/multigreedy_ftv44.png}
\end{center}
\caption{Zale¿noœæ œrednich i najlepszych rozwi¹zañ od liczby restartów algorytmu - greedy dla pliku ftv44}
\label{fig-schemat}
\end{figure}




\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/multisteepest_p43.png}
\end{center}
\caption{Zale¿noœæ œrednich i najlepszych rozwi¹zañ od liczby restartów algorytmu - steepest dla pliku p43}
\label{fig-schemat}
\end{figure}

\begin{figure}[H]
\begin{center}
\includegraphics[width=1.0\textwidth]{diagrams/multigreedy_p43.png}
\end{center}
\caption{Zale¿noœæ œrednich i najlepszych rozwi¹zañ od liczby restartów algorytmu -- greedy dla pliku p43}
\label{fig-schemat}
\end{figure}

Eksperyment przeprowadzono poprzez niezale¿ne uruchamianie algorytmu dla 1..300 restartów i obserwowanie jakie wyniki najlepsze oraz œrednie uda³o nam siê uzyskaæ. 
Zauwa¿yæ mo¿emy, ¿e algorytmy s¹ mocno zale¿ne od zadanej instancji. Przyk³ad p43 obrazuje nam jak bardzo czêsto trafiamy w okolice optimum, natomiast ftv44 czasami nawet dla znacznej liczby uruchomieñ nie trafia w dobre wyniki. Dla wielu odpaleñ widaæ stabilizowanie siê œrednich. Dla przypadku ftv44 widaæ silny trend poprawiania wyników do oko³o 100 uruchomieñ algorytmu steepest, dla greedy taka zale¿noœæ nie jest tak zauwa¿alna. Widaæ jednak, ¿e powtarzanie uruchomieñ prowadzi do prawdopodobnego poprawienia rezultatu, kosztem natomiast jest czas dzia³ania.

\section{Obiektywna ocena podobieñstwa znajdowanych rozwi¹zañ lokalnie optymalnych dla dwóch wybranych instancji}


\begin{table}[H]
\begin{tabular}{|l|llllllllll|}
\hline
   & 1    & 2    & 3    & 4    & 5    & 6    & 7    & 8    & 9    & 10   \\ \hline
1  & 1    & 0.15 & 0.16 & 0.14 & 0.17 & 0.16 & 0.16 & 0.16 & 0.15 & 0.13 \\
2  & 0.15 & 1    & 0.16 & 0.18 & 0.15 & 0.17 & 0.16 & 0.15 & 0.16 & 0.17 \\
3  & 0.16 & 0.16 & 1    & 0.17 & 0.16 & 0.17 & 0.19 & 0.16 & 0.17 & 0.17 \\
4  & 0.14 & 0.18 & 0.17 & 1    & 0.19 & 0.19 & 0.17 & 0.16 & 0.15 & 0.17 \\
5  & 0.17 & 0.15 & 0.16 & 0.19 & 1    & 0.16 & 0.16 & 0.16 & 0.15 & 0.15 \\
6  & 0.16 & 0.17 & 0.17 & 0.19 & 0.16 & 1    & 0.2  & 0.18 & 0.15 & 0.17 \\
7  & 0.16 & 0.16 & 0.19 & 0.17 & 0.16 & 0.2  & 1    & 0.18 & 0.19 & 0.14 \\
8  & 0.16 & 0.15 & 0.16 & 0.16 & 0.16 & 0.18 & 0.18 & 1    & 0.18 & 0.18 \\
9  & 0.15 & 0.16 & 0.17 & 0.15 & 0.15 & 0.15 & 0.19 & 0.18 & 1    & 0.16 \\
10 & 0.13 & 0.17 & 0.17 & 0.17 & 0.15 & 0.17 & 0.14 & 0.18 & 0.16 & 1    \\ \hline
\end{tabular}
\caption{Macierz podobieñstwa dziesiêciu rozwi¹zañ stanowi¹cych optima lokalne - zbiór rbg443}
\label{fig-schemat}
\end{table}

\begin{table}[h]
\begin{tabular}{|l|llllllllll|}
\hline
   & 1    & 2    & 3    & 4    & 5    & 6    & 7    & 8    & 9    & 10   \\ \hline
1  & 1    & 0.17 & 0.17 & 0.15 & 0.16 & 0.18 & 0.15 & 0.16 & 0.16 & 0.17 \\
2  & 0.17 & 1    & 0.16 & 0.13 & 0.16 & 0.17 & 0.17 & 0.15 & 0.16 & 0.15 \\
3  & 0.17 & 0.16 & 1    & 0.16 & 0.2  & 0.18 & 0.17 & 0.15 & 0.17 & 0.17 \\
4  & 0.15 & 0.13 & 0.16 & 1    & 0.17 & 0.15 & 0.19 & 0.18 & 0.16 & 0.17 \\
5  & 0.16 & 0.16 & 0.2  & 0.17 & 1    & 0.17 & 0.17 & 0.15 & 0.17 & 0.14 \\
6  & 0.18 & 0.17 & 0.18 & 0.15 & 0.17 & 1    & 0.15 & 0.15 & 0.17 & 0.15 \\
7  & 0.15 & 0.17 & 0.17 & 0.19 & 0.17 & 0.15 & 1    & 0.14 & 0.16 & 0.16 \\
8  & 0.16 & 0.15 & 0.15 & 0.18 & 0.15 & 0.15 & 0.14 & 1    & 0.16 & 0.17 \\
9  & 0.16 & 0.16 & 0.17 & 0.16 & 0.17 & 0.17 & 0.16 & 0.16 & 1    & 0.17 \\
10 & 0.17 & 0.15 & 0.17 & 0.17 & 0.14 & 0.15 & 0.16 & 0.17 & 0.17 & 1    \\ \hline
\end{tabular}
\caption{Macierz podobieñstwa dziesiêciu rozwi¹zañ stanowi¹cych optima lokalne - zbiór rbg403}
\label{fig-schemat}
\end{table}

Powy¿sze tabele zawieraj¹ oceny podobieñstwa permutacji bêd¹cych rozwi¹zaniami znalezionymi za pomoc¹ dziesiêciokrotnego odpalenia algorytmu steepest dla zbiorów rbg443 oraz rbg403. Jako miarê podobieñstwa przyjêto liczbê wyst¹pieñ takich samych par s¹siadów w obu sekwencjach, podzielon¹ przez d³ugoœæ permutacji. 
Jak mo¿na zauwa¿yæ, podobieñstwo pomiêdzy znalezionymi rozwi¹zaniami jest niewielkie. Rozwi¹zania ró¿ni¹ siê od siebie w bardzo du¿ym stopniu.

\section{Wnioski}

\begin{itemize}
\item[•]Algorytmy heurystyczne i losowe osi¹gaj¹ znacznie gorsze wyniki ni¿ algorytmy przeszukiwania lokalnego. Czas ich dzia³ania jest jednak znacznie mniej uzale¿niony od rozmiaru instancji problemu.

\item[•]]Algorytmy greedy oraz steepest osi¹gaj¹ podobne wyniki. Algorytm greedy jest jednak du¿o bardziej efektywny. Liczba porównywanych przez niego rozwi¹zañ, roœnie wolniej wraz ze wzrostem rozmiaru instancji ni¿ w przypadku algorytmu steepest.

\item[•]Stosunkowo dobre wyniki osi¹ga prosta heurystyka polegaj¹ca na budowaniu wyniku w oparciu o najbli¿szego s¹siada. Mimo, ¿e odleg³oœci rozwi¹zañ od optimum, s¹ znacznie wiêksze ni¿ w przypadku algorytmów steepest i greedy, czas dzia³ania tej heurystyki jest znacznie mniejszy ni¿ w przypadku tych algorytmów.  

\item[•]Wielokrotne odpalanie algorytmów przeszukiwania lokalnego, zwiêksza szanse na znalezienie wyniku bli¿szego globalnemu optimum.

\item[•]Wyniki dla symulowanego wy¿arzania w du¿ej mierze podyktowane s¹ parametrami jakie zadamy algorytmowi. Nale¿y uwa¿nie je dobraæ, aby uzyskaæ zarówno dobre efekty jak i czas dzia³ania.


\item[•]Symulowane wy¿arzanie jest pochodn¹ algorytmu greedy, które cechuje siê wiêkszym czasem dzia³ania i które w ekstremalnym przypadku ( obni¿enia temperatury ) mo¿emy sprowadziæ do algorytmu greedy. Jednak ustawianie odpowiedniej temperatury prowadziæ mo¿e do poszukania lepszego optimum, kosztem lokalnego pogorszenia wyników.

\end{itemize}

\section{Napotkane trudnoœci}

\section{Uzasadnienie wprowadzanych ulepszeñ, propozycje udoskonaleñ i ich spodziewane efekty}
\subsection{Propozycje udoskonaleñ}
\begin{itemize}
\item[•]Sprawdzenie dzia³ania operatora s¹siedztwa 3-opt. Prawdopodobnie wiêksze s¹siedztwo znacznie wp³ynê³oby na czas poszukiwania rozwi¹zania przez algorytmy greedy i steepest. Jednoczeœnie algorytmy te, przeszukiwa³yby wiêksz¹ przestrzeñ rozwi¹zañ co pozytywnie wp³ynê³oby na odleg³oœæ wyników od optimum.
\end{itemize}
%%%%%%%%%%%%%%%% literatura %%%%%%%%%%%%%%%%

\bibliography{sprawozd}
\bibliographystyle{plain}


\end{document}

